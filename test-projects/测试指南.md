# Grape æµ‹è¯•é¡¹ç›®ä½¿ç”¨æŒ‡å—

æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•ä½¿ç”¨ Grape æµ‹è¯•é¡¹ç›®æ¥éªŒè¯ npm åŒ…ç®¡ç†åŠŸèƒ½ã€‚

## ç›®å½•ç»“æ„

```
test-projects/
â”œâ”€â”€ README.md                  # æµ‹è¯•é¡¹ç›®æ€»è§ˆ
â”œâ”€â”€ install.sh                 # å¿«é€Ÿå®‰è£…è„šæœ¬
â”œâ”€â”€ .gitignore                 # Git å¿½ç•¥é…ç½®
â”œâ”€â”€ vue3-demo/                 # Vue 3 æµ‹è¯•é¡¹ç›®
â”‚   â”œâ”€â”€ .npmrc                 # é¡¹ç›®çº§ npm é…ç½®
â”‚   â”œâ”€â”€ package.json           # é¡¹ç›®ä¾èµ–
â”‚   â”œâ”€â”€ src/                   # æºç 
â”‚   â””â”€â”€ README.md              # é¡¹ç›®è¯´æ˜
â””â”€â”€ <future-project>/          # æœªæ¥æµ‹è¯•é¡¹ç›®
```

## å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨ Grape æœåŠ¡

```bash
# åœ¨ Grape é¡¹ç›®æ ¹ç›®å½•
cd /path/to/grape

# æ„å»ºå¹¶è¿è¡Œ
make build
./bin/grape

# æˆ–ä½¿ç”¨é…ç½®æ–‡ä»¶
./bin/grape -c configs/config.yaml
```

**éªŒè¯æœåŠ¡è¿è¡Œï¼š**

```bash
curl http://localhost:4873/-/health
# åº”è¿”å›ï¼š{"status":"ok","time":"..."}
```

### 2. è¿›å…¥æµ‹è¯•é¡¹ç›®

```bash
cd test-projects/vue3-demo
```

### 3. éªŒè¯ npm é…ç½®

```bash
# æŸ¥çœ‹å½“å‰é¡¹ç›®çš„ npm é…ç½®
npm config list

# åº”çœ‹åˆ°ï¼š
# registry=http://localhost:4873
```

### 4. å®‰è£…ä¾èµ–

```bash
# æ–¹å¼ä¸€ï¼šä½¿ç”¨å®‰è£…è„šæœ¬ï¼ˆæ¨èï¼‰
cd test-projects
./install.sh

# æ–¹å¼äºŒï¼šæ‰‹åŠ¨å®‰è£…
cd test-projects/vue3-demo
npm install
```

### 5. è¿è¡Œé¡¹ç›®

```bash
npm run dev
# è®¿é—® http://localhost:5173
```

## æµ‹è¯•åœºæ™¯

### åœºæ™¯ 1ï¼šæµ‹è¯•å…¬å…±åŒ…å®‰è£…

```bash
cd test-projects/vue3-demo

# å®‰è£… lodashï¼ˆä¼šä» npmjs ç¼“å­˜ï¼‰
npm install lodash

# éªŒè¯å®‰è£…
npm list lodash

# æŸ¥çœ‹ Grape ç¼“å­˜
curl http://localhost:4873/-/api/packages
```

### åœºæ™¯ 2ï¼šæµ‹è¯• Scoped åŒ…å®‰è£…

```bash
# å®‰è£… @babel/core
npm install @babel/core

# å®‰è£… @vueuse/core
npm install @vueuse/core

# éªŒè¯
npm list | grep "@babel"
npm list | grep "@vueuse"
```

### åœºæ™¯ 3ï¼šæµ‹è¯•åŒ…ç‰ˆæœ¬ç®¡ç†

```bash
# å®‰è£…ç‰¹å®šç‰ˆæœ¬
npm install lodash@4.17.21

# å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬
npm install lodash@latest

# æŸ¥çœ‹å¯ç”¨ç‰ˆæœ¬
npm view lodash versions
```

### åœºæ™¯ 4ï¼šæµ‹è¯•ç§æœ‰åŒ…å‘å¸ƒ

```bash
# 1. ç™»å½• Grape
npm login --registry http://localhost:4873
# ç”¨æˆ·åï¼šadmin
# å¯†ç ï¼šadmin

# 2. åˆ›å»ºæµ‹è¯•åŒ…
mkdir -p test-package
cd test-package
npm init -y

# 3. ä¿®æ”¹ package.json
# è®¾ç½® "name": "@test/my-package"
# è®¾ç½® "publishConfig": { "registry": "http://localhost:4873" }

# 4. åˆ›å»º index.js
echo "module.exports = { hello: 'world' }" > index.js

# 5. å‘å¸ƒ
npm publish --registry http://localhost:4873

# 6. éªŒè¯å‘å¸ƒ
curl http://localhost:4873/@test/my-package
```

### åœºæ™¯ 5ï¼šæµ‹è¯•ç¼“å­˜æœºåˆ¶

```bash
# 1. ç¬¬ä¸€æ¬¡å®‰è£…ï¼ˆä»ä¸Šæ¸¸ä¸‹è½½ï¼‰
npm install express
time npm install express  # è®°å½•æ—¶é—´

# 2. æ¸…é™¤ node_modules
rm -rf node_modules

# 3. ç¬¬äºŒæ¬¡å®‰è£…ï¼ˆä» Grape ç¼“å­˜ï¼‰
time npm install express  # åº”è¯¥æ›´å¿«

# 4. æŸ¥çœ‹ Grape ç»Ÿè®¡
curl http://localhost:4873/-/api/stats
```

### åœºæ™¯ 6ï¼šæµ‹è¯•å¤šåŒ…ç®¡ç†å™¨

#### pnpm

```bash
cd test-projects/vue3-demo

# ä½¿ç”¨ pnpm å®‰è£…
pnpm install

# éªŒè¯
pnpm list
```

#### yarn

```bash
cd test-projects/vue3-demo

# ä½¿ç”¨ yarn å®‰è£…
yarn install

# éªŒè¯
yarn list
```

#### bun

```bash
cd test-projects/vue3-demo

# bun éœ€è¦ bunfig.toml
cat > bunfig.toml << 'EOF'
[install]
registry = "http://localhost:4873"
EOF

# ä½¿ç”¨ bun å®‰è£…
bun install
```

## éªŒè¯æµ‹è¯•

### æ£€æŸ¥ Grape ç¼“å­˜

```bash
# æŸ¥çœ‹åŒ…åˆ—è¡¨
curl http://localhost:4873/-/api/packages

# æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯
curl http://localhost:4873/-/api/stats

# æŸ¥çœ‹ä¸Šæ¸¸é…ç½®
curl http://localhost:4873/-/api/upstreams
```

### æ£€æŸ¥ Web UI

è®¿é—® http://localhost:4873 æŸ¥çœ‹ï¼š

- åŒ…åˆ—è¡¨
- åŒ…è¯¦æƒ…
- ç»Ÿè®¡ä¿¡æ¯

### æ£€æŸ¥æ—¥å¿—

```bash
# Grape æ—¥å¿—
tail -f /path/to/grape/data/grape.log

# æˆ–æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º
```

## å¸¸è§é—®é¢˜

### Q1: npm install å¤±è´¥ï¼Œæç¤ºè¿æ¥è¢«æ‹’ç»

**åŸå› ï¼š** Grape æœåŠ¡æœªå¯åŠ¨

**è§£å†³ï¼š**

```bash
# å¯åŠ¨ Grape
./bin/grape

# éªŒè¯
curl http://localhost:4873/-/health
```

### Q2: åŒ…å®‰è£…å¾ˆæ…¢

**åŸå› ï¼š** ç¬¬ä¸€æ¬¡ä»ä¸Šæ¸¸ä¸‹è½½

**è§£å†³ï¼š** ç­‰å¾…ä¸‹è½½å®Œæˆï¼Œåç»­å®‰è£…ä¼šä½¿ç”¨ç¼“å­˜

### Q3: å¦‚ä½•åˆ‡æ¢å›å®˜æ–¹æºï¼Ÿ

**ä¸´æ—¶ä½¿ç”¨å®˜æ–¹æºï¼š**

```bash
npm install <package> --registry https://registry.npmjs.org
```

**æ°¸ä¹…åˆ‡æ¢ï¼ˆä¸æ¨èï¼‰ï¼š**

```bash
npm set registry https://registry.npmjs.org
```

### Q4: å¦‚ä½•æ¸…ç†æµ‹è¯•é¡¹ç›®ï¼Ÿ

```bash
# æ¸…ç† node_modules
cd test-projects/vue3-demo
rm -rf node_modules package-lock.json

# æˆ–åˆ é™¤æ•´ä¸ªæµ‹è¯•é¡¹ç›®
cd test-projects
rm -rf vue3-demo
```

### Q5: å¦‚ä½•åˆ›å»ºæ–°çš„æµ‹è¯•é¡¹ç›®ï¼Ÿ

```bash
# 1. åˆ›å»ºç›®å½•
mkdir test-projects/my-test
cd test-projects/my-test

# 2. åˆ›å»º .npmrc
cat > .npmrc << 'EOF'
registry=http://localhost:4873
EOF

# 3. åˆå§‹åŒ–é¡¹ç›®
npm init -y

# 4. å®‰è£…åŒ…æµ‹è¯•
npm install lodash
```

## æµ‹è¯•æ£€æŸ¥æ¸…å•

åœ¨æäº¤æµ‹è¯•æŠ¥å‘Šå‰ï¼Œè¯·ç¡®è®¤ï¼š

- [ ] Grape æœåŠ¡æ­£å¸¸è¿è¡Œ
- [ ] .npmrc é…ç½®æ­£ç¡®
- [ ] å…¬å…±åŒ…å¯ä»¥å®‰è£…
- [ ] Scoped åŒ…å¯ä»¥å®‰è£…
- [ ] åŒ…å¯ä»¥ä»ç¼“å­˜åŠ è½½
- [ ] Web UI å¯ä»¥è®¿é—®
- [ ] ç»Ÿè®¡ä¿¡æ¯æ­£ç¡®æ˜¾ç¤º

## æ€§èƒ½æµ‹è¯•

### æµ‹è¯•ç¼“å­˜å‘½ä¸­ç‡

```bash
# ç¬¬ä¸€æ¬¡å®‰è£…ï¼ˆå†·å¯åŠ¨ï¼‰
rm -rf node_modules
time npm install

# ç¬¬äºŒæ¬¡å®‰è£…ï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰
rm -rf node_modules
time npm install

# æ¯”è¾ƒä¸¤æ¬¡æ—¶é—´
```

### æµ‹è¯•å¹¶å‘å®‰è£…

```bash
# åŒæ—¶å¯åŠ¨å¤šä¸ªå®‰è£…
for i in {1..5}; do
  (cd test-projects/vue3-demo && npm install) &
done

# ç­‰å¾…å®Œæˆ
wait
```

## ç›¸å…³æ–‡æ¡£

- [Grape ä½¿ç”¨æŒ‡å—](../docs/USAGE.md)
- [Grape API æ–‡æ¡£](../docs/API.md)
- [Grape é…ç½®æŒ‡å—](../configs/README.md)
- [Grape éƒ¨ç½²æŒ‡å—](../docs/DEPLOYMENT.md)

---

ğŸ‡ Grape Test Projects
